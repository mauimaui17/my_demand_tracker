{% extends "tracker/base.html" %}
<!--TODO: IN DEPTH ANALYSIS ON DEMAND DATA-->
<!-- +From which departments, so we need pie charts here-->
<!-- IF WE CAN EXTRACT MORE DATA FROM AMIS/SAIS? -->

{% block title %} {{course.course_title}} {% endblock %} {% load
crispy_forms_tags %} {% block content %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<div class="container" id="catalog-container">
  <div class="column">
    <div class="container-fluid shadow p-3 mb-5 bg-white rounded">
      <div class="row p-3">
        <div class="col"><b> Course Title: </b> {{course.course_title}}</div>
        <div class="col"><b>Demand:</b> {{users|length}}</div>
        <div class="col">
            {%if course.is_elective %}
                Elective
            {% else %}
                Not Elective
            {% endif %}
        </div>
      </div>
      <div class="row p-3">
        <div class="col">
          <b>Course Description</b> {{course.course_description}}
        </div>
        <div class="col"></div>
        <div class="col"></div>
      </div>
    </div>
  </div>
  <div class="container">
    <div>
        <ul class="nav nav-tabs" id="chartTabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="degreePrograms-tab" data-bs-toggle="tab" href="#degreePrograms" role="tab" aria-controls="degreePrograms" aria-selected="true">Degree Programs</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="demandBreakdown-tab" data-bs-toggle="tab" href="#demandBreakdown" role="tab" aria-controls="demandBreakdown" aria-selected="false">Demand Priority Breakdown</a>
            </li>
        </ul>
        <div class="tab-content" id="chartTabContent">
            <div class="tab-pane fade show active" id="degreePrograms" role="tabpanel" aria-labelledby="degreePrograms-tab">
                <canvas id="degreeProgramsChart" style="width: 50%; height: 50%"></canvas>
            </div>
            <div class="tab-pane fade" id="demandBreakdown" role="tabpanel" aria-labelledby="demandBreakdown-tab">
                <canvas id="demandBreakdownChart" style="width: 50%; height: 50%"></canvas>
            </div>
        </div>
    </div>
    <canvas id="myChart"  ></canvas>
  </div>

  
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    const ctx = document.getElementById("degreeProgramsChart");
    const breakdownData = {{breakdown | safe}};
    const labels = Object.keys(breakdownData);
    const data = Object.values(breakdownData);
    new Chart(ctx, {
      type: "doughnut",
      data: {
        labels: labels,
        datasets: [
          {
            label: "Demand Breakdown",
            data: data,
            borderWidth: 1,
          },
        ],
      }
    });
  </script>
  <script>
    const ctx2 = document.getElementById("demandBreakdown");
    const labels = ['First', 'Second', 'Third', 'Fourth' ];
    const data = [course.first_prio, course.second_prio, course.third_prio, course.fourth_prio];
    new Chart(ctx2, {
      type: "doughnut",
      data: {
        labels: labels,
        datasets: [
          {
            label: "Demand Breakdown",
            data: data,
            borderWidth: 1,
          },
        ],
      }
    });
  </script>
  {% endblock %}
</div>
